Это одно из самых сложных заданий, 
т.к. не по методичке совсем (за исключением того, где прописывается версия и описание).